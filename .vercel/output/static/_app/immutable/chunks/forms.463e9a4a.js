import{p as b}from"./parse.5567e4e2.js";import{j as a}from"./singletons.1fcf3084.js";a.disable_scroll_handling;a.goto;a.invalidate;const f=a.invalidateAll;a.preload_data;a.preload_code;a.before_navigate;a.after_navigate;const y=a.apply_action;function h(t){const o=JSON.parse(t);return o.data&&(o.data=b(o.data)),o}function v(t,o=()=>{}){const l=async({action:r,result:e,reset:i})=>{e.type==="success"&&(i!==!1&&HTMLFormElement.prototype.reset.call(t),await f()),(location.origin+location.pathname===r.origin+r.pathname||e.type==="redirect"||e.type==="error")&&y(e)};async function s(r){r.preventDefault();const e=new URL(r.submitter?.hasAttribute("formaction")?r.submitter.formAction:HTMLFormElement.prototype.cloneNode.call(t).action),i=new FormData(t),p=r.submitter?.getAttribute("name");p&&i.append(p,r.submitter?.getAttribute("value")??"");const d=new AbortController;let m=!1;const u=await o({action:e,cancel:()=>m=!0,controller:d,data:i,form:t})??l;if(m)return;let c;try{const n=await fetch(e,{method:"POST",headers:{accept:"application/json","x-sveltekit-action":"true"},cache:"no-store",body:i,signal:d.signal});c=h(await n.text()),c.type==="error"&&(c.status=n.status)}catch(n){if(n?.name==="AbortError")return;c={type:"error",error:n}}u({action:e,data:i,form:t,update:n=>l({action:e,result:c,reset:n?.reset}),result:c})}return HTMLFormElement.prototype.addEventListener.call(t,"submit",s),{destroy(){HTMLFormElement.prototype.removeEventListener.call(t,"submit",s)}}}export{y as a,v as e,f as i};
